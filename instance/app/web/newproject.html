<!--  
/*
* Copyright 2013 Bizosys Technologies Limited
*
* Licensed to the Bizosys Technologies Limited (Bizosys) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The Bizosys licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
 -->

<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>HSearch - New Project</title>
	
  <link rel="shortcut icon" href="images/favicon.gif">
  <link rel="stylesheet" href="css/slick.grid.css" type="text/css"/>
  <link rel="stylesheet" href="controls/slick.columnpicker.css" type="text/css"/>
  
  <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="css/hsearch.css" type="text/css"/>
  
<script src="js/lib/firebugx.js"></script>

<script src="js/lib/jquery-1.7.min.js"></script>
<script src="js/lib/jquery-ui-1.8.16.custom.min.js"></script>
<script src="js/lib/jquery.event.drag-2.2.js"></script>
<script src="js/bootstrap.js"></script>
    
<script src="js/slick.core.js"></script>
<script src="js/plugins/slick.checkboxselectcolumn.js"></script>
<script src="js/plugins/slick.autotooltips.js"></script>
<script src="js/plugins/slick.cellrangedecorator.js"></script>
<script src="js/plugins/slick.cellrangeselector.js"></script>
<script src="js/plugins/slick.cellcopymanager.js"></script>
<script src="js/plugins/slick.cellselectionmodel.js"></script>
<script src="js/plugins/slick.rowselectionmodel.js"></script>
<script src="controls/slick.columnpicker.js"></script>
<script src="js/slick.formatters.js"></script>
<script src="js/slick.editors.js"></script>
<script src="js/slick.grid.js"></script>

<script type="text/javascript" src="js/newProject.js"></script>

</head>
<body>
<div id="wrapper">
		<div class="navbar navbar-default navbar-fixed-top" data-role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse"
						data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span> <span
							class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
					<a class="navbar-brand logo-nav" href="http://www.hadoopsearch.net" target="_blank">
						<img height="50px" width="190px" src="images/hsearch-logo.png" />
					</a>
				</div>
				<div class="collapse navbar-collapse collapse">
					<ul class="nav navbar-nav navbar-right">
					</ul>
				</div>
				<!-- /.navbar-collapse -->
			</div>
			<!-- /.container -->
		</div>
				
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<img id="loader" src="images/ajax-loader-small.gif" style="display:none; position: fixed;left:50%;top:50%;"/>
					<div class="tableContainer">
						<div class="tableHeader">New Project Setup</div>			
						<div class="tableContent">
							<table class='txtland-table'>
								<thead>
									<tr><th style="width: 30%;">Poperty Name</th>
										<th style="width: 70%">Property Value</th>
									</tr></thead>
								<tbody>
									<tr><td style="text-align: right; font-weight: bold;">Project Name (A valid java class name) : </td>
										<td><input type="text" class="form-control input-md" id="txtProjectName"  name="txtProjectName" value="" /></td>
									</tr>
									<tr><td style="text-align: right; font-weight: bold;">Datasource HDFS Path : </td>
										<td><input class="form-control input-md" id="txtHdfsPath" name="txtHdfsPath" type="text" value="" /></td>
									</tr>
									<tr>
										<td colspan="2" style="text-align: center;">
											<input type="button" name="loadButton" name="loadButton" class="txtBtn blueBg" value="Get Top Rows" onclick="loadSampleData();"/>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div id="showDataDiv" class="row" style="display: none;">
				<div class="col-md-12">
					<div class="tableContainer">
						<div style="padding: 5px;">
							<label>Choose Data Column Sepearator :&nbsp;&nbsp;</label>
	                        <label style="font-weight: normal;"><input type="radio" value="1" checked name="delim" onchange="repaintGrid()" /> Tab &nbsp;</label>
						    <label style="font-weight: normal;"><input type="radio" value="2" name="delim" onchange="repaintGrid()" /> Comma &nbsp;</label>
						    <label style="font-weight: normal;"><input type="radio" value="3" name="delim" onchange="repaintGrid()" /> Semicolon &nbsp;</label>
						    <label style="font-weight: normal;"><input type="radio" value="4" name="delim" onchange="repaintGrid()" /> Space &nbsp;</label>
						    <label style="font-weight: normal;"><input type="radio" value="5" name="delim" onchange="repaintGrid()" /> Other &nbsp;</label>
						    <input type="text" value="" name="otherdelim" id="otherdelim" class="form-control" style="width:30px;padding: 0;text-align: center;height:25px; display: inline-block !important;" maxlength="1" disabled="disabled" onchange="repaintGridCustomDelim()" />

							<br/>
							<label><input type="checkbox" name="isfirstheader"  id="isfirstheader" style="width:20px;" onchange="repaintGrid();" />First row is header</label> &nbsp;&nbsp;&nbsp;
							<label><input type="checkbox" name="incrementalindex"  id="incrementalindex" style="width:20px;" />Perform Incremental Index</label>
							
							<hr style="margin-top: 15px;margin-bottom: 15px;"/>

							<label>Click on below buttons to set common field properties to be used for field in indexing of your data :</label>
							<br/>
							<input type="button" class="txtBtn blueBg" value="Fields To Index" onclick='setFields("Indexable Columns", "stored");'/>
							<input type="button" class="txtBtn blueBg" value="Partition Fields" onclick='setFields("Partition Columns", "partition");'/>
							<input type="button" class="txtBtn blueBg" value="Repeatable Fields" onclick='setFields("Repeat Fields", "repeatable");'/>
							<input type="button" class="txtBtn blueBg" value="Fields To Cache" onclick='setFields("Cache Fields", "cache");'/>
							<input type="button" class="txtBtn blueBg" value="Fields To Compress" onclick='setFields("Compressed Fields", "compress");'/>
							<input type="button" class="txtBtn blueBg" value="Skip Null Fields" onclick='setFields("Skip Null Fields", "skipNull");'/>
							<input type="button" class="txtBtn blueBg" value="Standard Analyzer" onclick='setFields("Standard Analysis", "stdAnalyzer");'/>
							<br/>
							<br/>
							<label>Click on below buttons to set data type of your fields :</label>
							<br/>
						    <input type="button" class="txtBtn blueBg" value="String" onclick='setFields("String Fields", "String");'/>
							<input type="button" class="txtBtn blueBg" value="Boolean" onclick='setFields("Boolean Fields", "boolean");'/>
							<input type="button" class="txtBtn blueBg" value="Byte" onclick='setFields("Byte Fields", "byte");'/>
							<input type="button" class="txtBtn blueBg" value="Short" onclick='setFields("Short Fields", "short");'/>
							<input type="button" class="txtBtn blueBg" value="Integer" onclick='setFields("Integer Fields", "int");'/>
							<input type="button" class="txtBtn blueBg" value="Float" onclick='setFields("Float Fields", "float");'/>
							<input type="button" class="txtBtn blueBg" value="Long" onclick='setFields("Long Fields", "long");'/>
							<input type="button" class="txtBtn blueBg" value="Double" onclick='setFields("Double Fields", "double");'/>
							<hr style="margin-top: 10px;margin-bottom: 10px;"/>
						</div>						
						
						<div class="tableHeader" style="border-top: 1px solid #CDCDCD;">Top Rows (Click on column header to set index property or use above buttons or paste schema below)</div>			
						<div class="tableContent">
							<div id="grdSampleData" style="height:260px; width:100%; border-bottom: 1px solid #dddddd">Data Preview</div>
							<div style="padding: 10px; text-align: center;">
								<input type="button" name="indexButton" name="indexButton" class="txtBtn greenBg" value="Start Indexing" onclick="indexData();"/> &nbsp;&nbsp;&nbsp;
								<input type="button" name="indexWithXmlButton" name="indexWithXmlButton"  class="txtBtn greenBg" value="Upload Schema and Start Indexing" onclick="indexDataWithSchemaUpload();"/>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="tableContainer">
						<div class="tableContent">
							<table class='txtland-table'>
								<thead>
									<tr><th>Property</th><th style="width: 10%">Data Type</th><th>Description</th></tr>
								</thead>
								<tbody>
									<tr><td>tableName</td><td>String</td><td>The Hbase table name to index the data in.</td></tr>
									<tr><td>familyName</td><td>String</td><td>The family name to be used for the index table.</td></tr>
									<tr><td>fieldSeparator</td><td>Char</td><td>If the data is indexed from flat file then this would be separator used in the flat file(eg. Pipe('|') Tab('\t') Comma(,) etc.)</td></tr>
									<tr><td>append</td><td>Boolean</td><td>If a new data is to be indexed without deleting the existing data then this field should be true</td></tr>
									<tr><td>delete</td><td>Boolean</td><td>If few ids are not to be included in the returned resultset than this should be set to true.</td></tr>
									<tr><td>name</td><td>String</td><td>The name of the field which is indexed. This is used for querying</td></tr>
									<tr><td>sourcesequence</td><td>Integer</td><td>If indexed from flat file then this would be position of the field in the flat file otherwise should be unique integer number</td></tr>
									<tr><td>sourcename</td><td>String</td><td>The name of the field used in creation of VO</td></tr>
									<tr><td>type</td><td>String</td><td>The java data type for the field</td></tr>
									<tr><td>indexed</td><td>Boolean</td><td>If the field needs to be indexed then this should be true</td></tr>
									<tr><td>stored</td><td>Boolean</td><td>If the field is stored such that data can be fetched then it should be true</td></tr>
									<tr><td>repeatable</td><td>Boolean</td><td>If the field's data is repeated in nature then this should be true</td></tr>
									<tr><td>cache</td><td>Boolean</td><td>If the field needs to be cached such that subsequent query data is served from cache the this field should be true</td></tr>
									<tr><td>mergekey</td><td>Boolean</td><td>If the field is to be used as partition key part then this should be true</td></tr>
									<tr><td>mergeposition</td><td>Integer</td><td>Position of the field in partition key formation if mergekey is true</td></tr>
									<tr><td>compress</td><td>Boolean</td><td>If the field's data needs to be compressed this should be true</td></tr>
									<tr><td>skipNull</td><td>Boolean</td><td>If the field need to be skipped during indexing when data is null or empty then this should be set to true</td></tr>
									<tr><td>defaultValue</td><td>String</td><td>The default value to be used when the data is null or empty and skipNull is set to false</td></tr>
									<tr><td>analyzed</td><td>Boolean</td><td>If the field needs to be analyzed and broken into tokens then this should be set to true</td></tr>
									<tr><td>analyzer</td><td>String</td><td>The complete lucene or custom analyzer class name to be used for analyzing/tokenizing the field if analyzed is true</td></tr>
									<tr><td>expression</td><td>String</td><td>If more than one field's data needs to be appended for indexing then the entire field's name should be added.</td></tr>
									<tr><td>biword</td><td>Boolean</td><td>If biword search is enabled then this should be set to true. Biword search eg: New York is a  city. If phrase York is searched the biword search will make it New York etc.</td></tr>
									<tr><td>triword</td><td>Boolean</td><td>If triword search is enabled then this should be set to true. Triword search eg : New York in America is a  city. If phrase York is searched the triword search will make it New York America etc.</td></tr>
								</tbody>
							</table>
							</div>
							</div>
						</div>
					</div>
				</div>
			</div>			
			<!-- Modal -->
				<div class="modal fade" id="propertyWindowDiv" tabindex="-1" data-role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				  <div class="modal-dialog">
				    <div class="modal-content">
				      <div class="modal-header">
				        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				        <h4 class="modal-title" id="propertyModalTitle">Properties</h4>
				      </div>
				      <div class="modal-body">
			      		<table class='txtland-table property-windowTable' style="border: 1px solid #ccc;">
							<thead>
								<tr><th style="width: 30%;padding: 6px !important">Poperty Name</th>
									<th style="width: 70%;padding: 6px !important">Property Value</th>
								</tr></thead>
							<tbody>
								<tr><td style="text-align: right; font-weight: bold;">Field type : </td>
									<td>
										<select id="txtFldType" name="txtFldType" class="form-control" style="height: 28px;padding: 1px;">
											<option value="String">String</option>
											<option value="int">int</option>
											<option value="float">float</option>
											<option value="double">double</option>
											<option value="long">long</option>
											<option value="short">short</option>
											<option value="boolean">boolean</option>
											<option value="byte">byte</option>
										</select>
									</td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Index : </td>
									<td><input id="txtIndex" name="txtIndex" type="checkbox" checked/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Store : </td>
									<td><input id="txtStore" name="txtStore" type="checkbox" checked/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Is Repeatable : </td>
									<td><input id="txtRepeatable" name="txtRepeatable" type="checkbox" checked/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Is Partition Key : </td>
									<td><input id="txtPartitionKey" name="txtPartitionKey" type="checkbox" 
												onchange=" $('#txtPartitionKey').attr('checked') ? $('#txtPartitionPos').removeAttr('disabled') : $('#txtPartitionPos').attr('disabled', 'disabled')"/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Partition Position : </td>
									<td><input id="txtPartitionPos" name="txtPartitionPos" class="form-control" style="height: 28px;padding: 1px;" type="text" disabled="disabled"/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Cache : </td>
									<td><input id="txtCache" name="txtCache" type="checkbox" checked/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Compress : </td>
									<td><input id="txtCompress" name="txtCompress" type="checkbox"/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Analyze : </td>
									<td>
										<input id="txtAnalyze" name="txtAnalyze" type="checkbox" onchange="analyzerChanged()"/>
									</td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Analyzer : </td>
									<td>
										<select id="txtAnalyzer" name="txtAnalyzer" disabled="disabled" class="form-control" style="height: 28px;padding: 1px;">
											<option value="org.apache.lucene.analysis.standard.StandardAnalyzer">org.apache.lucene.analysis.standard.StandardAnalyzer</option>
											<option value="org.apache.lucene.analysis.KeywordAnalyzer">org.apache.lucene.analysis.KeywordAnalyzer</option>
											<option value="org.apache.lucene.analysis.SimpleAnalyzer">org.apache.lucene.analysis.SimpleAnalyzer</option>
											<option value="org.apache.lucene.analysis.WhitespaceAnalyzer">org.apache.lucene.analysis.WhitespaceAnalyzer</option>
											<option value="com.bizosys.unstructured.StopwordAndSynonymAnalyzer">com.bizosys.unstructured.StopwordAndSynonymAnalyzer</option>
										</select>
									</td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Biword Index : </td>
									<td><input id="txtBiWord" name="txtBiWord" type="checkbox" disabled="disabled"/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Triword Index : </td>
									<td><input id="txtTriWord" name="txtTriWord" type="checkbox" disabled="disabled"/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Skip Null : </td>
									<td><input id="txtSkipNull" name="txtSkipNull" type="checkbox" checked/></td>
								</tr>
								<tr>
									<td style="text-align: right; font-weight: bold;">Default Value : </td>
									<td><input id="txtDefaultValue" name="txtDefaultValue" type="text" class="form-control" style="height: 28px;padding: 1px;"/></td>
								</tr>
								<tr style="text-align: center;">
									<td colspan="2"><input type="button" class="txtBtn greenBg" value="Save" onclick="saveProperties();"></td>
								</tr>
								
							</tbody>
						</table>
				      </div>
				    </div><!-- /.modal-content -->
				  </div><!-- /.modal-dialog -->
				</div><!-- /.modal -->

			<!-- Modal Set Fields-->
				<div class="modal fade" id="divFieldSetter" tabindex="-1" data-role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				  <div class="modal-dialog" style="width:300px !important;">
				    <div class="modal-content">
				      <div class="modal-header">
				        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				        <h4 class="modal-title" id="divFieldSetterHeader">Header</h4>
				      </div>
				      <div class="modal-body" id="divFieldSetterChecked" style="height: 450px !important;overflow:auto;">
				      </div>
				      <div class="modal-footer" style="text-align: center;">
				      		<input type="button" value="Select All" onclick='applyFieldAll(this);' class="txtBtn greenBg"/>&nbsp;&nbsp;&nbsp;
							<input type="button" value="Apply" onclick="applyFieldSettings();" class="txtBtn greenBg"/>
				      </div>
				    </div><!-- /.modal-content -->
				  </div><!-- /.modal-dialog -->
				</div><!-- /.modal -->

			<!-- Modal Upload Schema-->
				<div class="modal fade" id="uploadWindowDiv" tabindex="-1" data-role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				  <div class="modal-dialog" style="height: 90% !important;width:92% !important;overflow:auto;">
				    <div class="modal-content">
				      <div class="modal-header">
				        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				        <h4 class="modal-title">Schema XML</h4>
				      </div>
				      <div class="modal-body" style="padding: 5px;">
				      	<textarea id="xmlcontent" name="xmlcontent" class="form-control" style="min-height: 350px" spellcheck="false"></textarea>
				      </div>
				      <div class="modal-footer" style="text-align: center;">
						    <input type="button" value="Start Indexing" class="txtBtn greenBg" onclick="$('#uploadWindowDiv').modal('hide');var schemaVal = ($('#xmlcontent').val()); if ( schemaVal.length > 0 ) startJob(schemaVal); " />
				      </div>
				    </div><!-- /.modal-content -->
				  </div><!-- /.modal-dialog -->
				</div><!-- /.modal -->
							
		</div><!-- /.Container -->
		</div><!-- /.Wrapper -->
</body>
</html>