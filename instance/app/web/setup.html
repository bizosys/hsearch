<!--  
/*
* Copyright 2013 Bizosys Technologies Limited
*
* Licensed to the Bizosys Technologies Limited (Bizosys) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The Bizosys licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
 -->

<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>HSearch - Setup</title>
  <link rel="shortcut icon" href="images/favicon.gif">
  <link rel="stylesheet" href="css/slick.grid.css" type="text/css"/>
  <link rel="stylesheet" href="css/smoothness/jquery-ui-1.8.16.custom.css" type="text/css"/>
  <link rel="stylesheet" href="controls/slick.columnpicker.css" type="text/css">

  <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="css/hsearch.css" type="text/css"/>
    
<script src="js/lib/firebugx.js"></script>

<script src="js/lib/jquery-1.7.min.js"></script>
<script src="js/lib/jquery-ui-1.8.16.custom.min.js"></script>
<script src="js/lib/jquery.event.drag-2.2.js"></script>

<script src="js/slick.core.js"></script>
<script src="js/plugins/slick.checkboxselectcolumn.js"></script>
<script src="js/plugins/slick.autotooltips.js"></script>
<script src="js/plugins/slick.cellrangedecorator.js"></script>
<script src="js/plugins/slick.cellrangeselector.js"></script>
<script src="js/plugins/slick.cellcopymanager.js"></script>
<script src="js/plugins/slick.cellselectionmodel.js"></script>
<script src="js/plugins/slick.rowselectionmodel.js"></script>
<script src="controls/slick.columnpicker.js"></script>
<script src="js/slick.formatters.js"></script>
<script src="js/slick.editors.js"></script>
<script src="js/slick.grid.js"></script>

<style type="text/css">
	.mrv2{
		display:none;
	}
</style>
<script type="text/javascript">
	
	$(document).ready(function(){
		$(".mrv2").css("display","none");
	});
	
	function showMR(isMR1){
		if(isMR1){
			$(".mrv1").show();
			$(".mrv2").hide();			
		} else {
			$(".mrv1").hide();
			$(".mrv2").show();						
		}
	}

	var stepsGrid;

    /** ********************************************** */
	
	function requiredFieldValidator(value) {
		if (value == null || value == undefined || !value.length) {
		  return {valid: false, msg: "This is a required field"};
		} else {
		  return {valid: true, msg: null};
		}
	}
	
	/** ********************************************** */
	
	function applyConfiguration() {
		var hbaseRootdir = $('#txtHbaseRoot').val();
		var hbaseZooKeeper = $('#txtZooKeeper').val();
		var fsDefaultName = $('#txtFsDefaultName').val();
		var jobTrackerAddr = '';
		var jobHttpAddr = '';
		var jobHostName = '';
		var mrVersion = $('input[name="mrv"]:checked').val();
		
		if(mrVersion === "mrv1"){
			jobTrackerAddr = $('#txtJobTrackerAddr').val();
			jobHttpAddr = $('#txtJobHttpAddr').val();
		} else {
			jobTrackerAddr = $('#txtYarnTrackerAddr').val();
			jobHttpAddr = $('#txtYarnHttpAddr').val();
			jobHostName = $('#txtYarnHostName').val();
		}
		var xmlData = {
			action: "hadoopsetup",
			hbaserootdir : hbaseRootdir,
			hbasezookeeper : hbaseZooKeeper,
			fsdefaultname : fsDefaultName,
			mrVersion : mrVersion,
			jobTrackerAddr : jobTrackerAddr,
			jobHttpAddr : jobHttpAddr,
			jobHostName : jobHostName
		};
 		$.ajax({
			type: "POST",
			async: false,
			url: "setup.xml",
			data: xmlData,
			cache:false,
			dataType: "text",
			success: function onSuccess(data){	
				window.location.href="index.html";
			},
			error: function onError(data){
				alert(data);
			}
		});  
	}	
	
	
</script>
</head>
<body>
<div id="wrapper">
		<div class="navbar navbar-default navbar-fixed-top" data-role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse"
						data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span> <span
							class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
					<a class="navbar-brand logo-nav" href="http://www.hadoopsearch.net" target="_blank">
						<img height="50px" width="190px" src="images/hsearch-logo.png" />
					</a>
				</div>
				<div class="collapse navbar-collapse collapse">
					<ul class="nav navbar-nav navbar-right">
					</ul>
				</div>
				<!-- /.navbar-collapse -->
			</div>
			<!-- /.container -->
		</div>
				
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="tableContainer">
						<div class="tableHeader">Configuration Properties</div>			
						<div class="tableContent">
							<table class='txtland-table'>
								<thead>
									<tr><th style="width: 30%;">Poperty Name</th>
										<th style="width: 70%">Property Value</th>
									</tr></thead>
								<tbody>
									<tr><td style="text-align: right; font-weight: bold;">hbase.rootdir : </td>
										<td><input type="text" id="txtHbaseRoot"  name="txtHbaseRoot" class="form-control input-md" value="hdfs://localhost:8020/hbase" spellcheck="false"/></td>
									</tr>
									<tr><td style="text-align: right; font-weight: bold;">hbase.zookeeper.quorum : </td>
										<td><input id="txtZooKeeper" name="txtZooKeeper" type="text" class="form-control input-md" value="localhost" spellcheck="false"/></td>
									</tr>
									<tr><td style="text-align: right; font-weight: bold;">fs.default.name : </td>
										<td><input type="text" id="txtFsDefaultName"  name="txtFsDefaultName" class="form-control input-md" value="hdfs://localhost:8020" spellcheck="false"/></td>
									</tr>
									<tr><td style="text-align: right; font-weight: bold;">Mapreduce Version : </td>
										<td>
											<label><input type="radio" id="mrv" name="mrv" onclick="showMR(true);" value="mrv1" checked="checked"/> MapReduce-v1</label>
											<label style="margin-left: 30px;"><input type="radio" id="mrv" name="mrv" onclick="showMR(false);" value="mrv2"/> MapReduce-v2 (Uses Yarn)</label>
										</td>
									</tr>
									<tr class="mrv1"><td style="text-align: right; font-weight: bold;">mapred.job.tracker : </td>
										<td><input type="text" id="txtJobTrackerAddr"  name="txtJobTrackerAddr" class="form-control input-md" value="hdfs://localhost:8021" spellcheck="false"/></td>
									</tr>
									<tr class="mrv1"><td style="text-align: right; font-weight: bold;">mapreduce.jobtracker.http.address : </td>
										<td><input type="text" id="txtJobHttpAddr"  name="txtJobHttpAddr" class="form-control input-md" value="localhost:50030" spellcheck="false"/></td>
									</tr>
									<tr class="mrv2"><td style="text-align: right; font-weight: bold;">yarn.resourcemanager.hostname : </td>
										<td><input type="text" id="txtYarnHostName"  name="txtYarnHostName" class="form-control input-md" value="localhost" spellcheck="false"/></td>
									</tr>
									<tr class="mrv2"><td style="text-align: right; font-weight: bold;">yarn.resourcemanager.address : </td>
										<td><input type="text" id="txtYarnTrackerAddr"  name="txtYarnTrackerAddr" class="form-control input-md" value="hdfs://localhost:8032" spellcheck="false"/></td>
									</tr>
									<tr class="mrv2"><td style="text-align: right; font-weight: bold;">yarn.resourcemanager.webapp.address : </td>
										<td><input type="text" id="txtYarnHttpAddr"  name="txtYarnHttpAddr" class="form-control input-md" value="localhost:8088" spellcheck="false"/></td>
									</tr>									
								</tbody>
							</table>
							<div style="text-align: center;margin: 6px;">
								<input type="button" value="Apply Configuration" class="txtBtn greenBg" onclick="applyConfiguration();"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
</div>

</body>
</html>
